<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.png?v=3" type="image/png" />
  <link rel="stylesheet" href="css/site.css?v=7" />
  <title>lockify — JWT (HS256) — secret + token</title>
  <meta name="color-scheme" content="light dark" />
  
</head>
<body>
  <header>
    <div class="brand"><img src="favicon.png" alt="lockify" width="22" height="22" /> <span>lockify</span></div>
    <nav> 
      <a href="./">Início</a> 
      <a href="./snippets-index.html" class="current">Snippets</a> 
      <a href="https://github.com/lockifyoffice/lockify" target="_blank" rel="noopener">GitHub</a> 
    </nav>
  </header>

  <main>
    <h1>JWT (HS256) — secret + token</h1>
    <p class="muted">Gere um segredo forte e assine/verifique tokens. Recomendado: ≥ 32 bytes para HS256 (≥ 64 bytes para HS512).</p>

    <div class="tabs">
      <button class="tab active" data-lang="node">Node.js</button>
      <button class="tab" data-lang="python">Python</button>
    </div>

    <pre><code id="code"></code></pre>
    <button class="copy" id="copy">Copiar</button>

    <div class="card muted">
      Instalação:
      • Node: npm i jsonwebtoken
      • Python: pip install PyJWT
    </div>
  </main>

  <script>
    const snippets = {
      node:
`// npm i jsonwebtoken
const crypto = require('crypto');
const jwt = require('jsonwebtoken');

// Gere um segredo forte (32 bytes) em base64
const secret = crypto.randomBytes(32).toString('base64');

// Assinar um token (HS256) com expiração de 1 hora
const token = jwt.sign({ sub: '123', role: 'user' }, secret, { algorithm: 'HS256', expiresIn: '1h' });

// Verificar/decodificar
const decoded = jwt.verify(token, secret, { algorithms: ['HS256'] });

console.log('JWT_SECRET=' + secret);
console.log('JWT=' + token);
console.log(decoded);`,
      python:
`# pip install PyJWT
import secrets, base64, jwt, datetime

# Gere um segredo forte (32 bytes) — base64
secret = base64.b64encode(secrets.token_bytes(32)).decode()

# Assinar um token (HS256) com expiração de 1 hora
token = jwt.encode(
    {"sub": "123", "role": "user", "exp": datetime.datetime.now(datetime.timezone.utc) + datetime.timedelta(hours=1)},
    secret,
    algorithm="HS256"
)

# Verificar/decodificar
decoded = jwt.decode(token, secret, algorithms=["HS256"])

print("JWT_SECRET=" + secret)
print("JWT=" + token)
print(decoded)`
    };

    let current = 'node';
    const codeEl = document.getElementById('code');
    const render = () => { codeEl.textContent = snippets[current]; };
    render();

    document.querySelectorAll('.tab').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        current = btn.dataset.lang;
        render();
      });
    });

    document.getElementById('copy').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(codeEl.textContent);
        const btn = document.getElementById('copy');
        const prev = btn.textContent; btn.textContent = 'Copiado!';
        setTimeout(() => btn.textContent = prev, 1200);
      } catch {
        alert('Não foi possível copiar. Copie manualmente.');
      }
    });
  </script>
</body>
</html>
