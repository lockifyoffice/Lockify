<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.png?v=3" type="image/png" />
  <link rel="stylesheet" href="css/site.css?v=1" />
  <title>lockify — Argon2id (hash/verify)</title>
  <meta name="color-scheme" content="light dark" />
 
</head>
<body>
 <header>
  <div class="brand">
    <img src="favicon.png" alt="lockify" width="22" height="22" />
    <span>lockify</span>
  </div>
<nav> 
  <a href="./">Início</a> 
  <a href="./snippets-index.html" class="current">Snippets</a> 
  <a href="https://github.com/lockifyoffice/lockify" target="_blank" rel="noopener">GitHub</a> 
</nav>
</header>

  <main>
    <h1>Argon2id — hash/verify de senha</h1>
    <p class="muted">Use Argon2id para armazenar senhas. Ajuste memória/tempo conforme o servidor. Não use para criptografar dados.</p>

    <div class="tabs">
      <button class="tab active" data-lang="node">Node.js</button>
      <button class="tab" data-lang="python">Python</button>
    </div>

    <pre><code id="code"></code></pre>
    <button class="copy" id="copy">Copiar</button>

    <div class="card muted">
      Instalação:
      • Node: npm i argon2
      • Python: pip install argon2-cffi
      Parâmetros sugeridos: memória 64 MiB, timeCost 3, parallelism 1 (ajuste conforme seu ambiente).
    </div>
  </main>

  <script>
    const snippets = {
      node:
`// npm i argon2
const argon2 = require('argon2');

async function hashPassword(password) {
  return argon2.hash(password, {
    type: argon2.argon2id,
    memoryCost: 65536, // 64 MiB
    timeCost: 3,
    parallelism: 1,
  });
}

async function verifyPassword(password, hash) {
  return argon2.verify(hash, password); // true/false
}

// Exemplo de uso:
// (async () => {
//   const h = await hashPassword('minhaSenha!');
//   console.log(h);
//   console.log('ok?', await verifyPassword('minhaSenha!', h));
// })();`,
      python:
`# pip install argon2-cffi
from argon2 import PasswordHasher

ph = PasswordHasher(memory_cost=65536, time_cost=3, parallelism=1)

# Gerar hash
h = ph.hash("minhaSenha!")

# Verificar (lança exceção se falhar)
ph.verify(h, "minhaSenha!")

print(h)`
    };

    let current = 'node';
    const codeEl = document.getElementById('code');
    const render = () => { codeEl.textContent = snippets[current]; };
    render();

    document.querySelectorAll('.tab').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        current = btn.dataset.lang;
        render();
      });
    });

    document.getElementById('copy').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(codeEl.textContent);
        const btn = document.getElementById('copy');
        const prev = btn.textContent; btn.textContent = 'Copiado!';
        setTimeout(() => btn.textContent = prev, 1200);
      } catch {
        alert('Não foi possível copiar. Copie manualmente.');
      }
    });
  </script>
</body>
</html>
